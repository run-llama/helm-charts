suite: temporal-helpers-tests
templates:
  - ../templates/llamacloud/deployment.yaml
  - ../templates/llamacloud/service.yaml
release:
  name: llamacloud
  namespace: default
capabilities:
  majorVersion: 1
  minorVersion: 28
tests:
  # Test that standard deployments are created regardless of temporal.enabled
  - it: should create standard deployments when temporal is disabled
    set:
      temporal.enabled: false
      config.frontend.enabled: false
      config.parseOcr.enabled: false
      config.parseLayoutDetection.enabled: false
    template: ../templates/llamacloud/deployment.yaml
    asserts:
      - hasDocuments:
          count: 5

  - it: should create standard deployments when temporal is enabled
    set:
      temporal.enabled: true
      config.frontend.enabled: false
      config.parseOcr.enabled: false
      config.parseLayoutDetection.enabled: false
    template: ../templates/llamacloud/deployment.yaml
    asserts:
      - hasDocuments:
          count: 5

  - it: should create standard services when temporal is disabled
    set:
      temporal.enabled: false
      config.frontend.enabled: false
      config.parseOcr.enabled: false
      config.parseLayoutDetection.enabled: false
    template: ../templates/llamacloud/service.yaml
    asserts:
      - hasDocuments:
          count: 5

  - it: should create standard services when temporal is enabled
    set:
      temporal.enabled: true
      config.frontend.enabled: false
      config.parseOcr.enabled: false
      config.parseLayoutDetection.enabled: false
    template: ../templates/llamacloud/service.yaml
    asserts:
      - hasDocuments:
          count: 5
